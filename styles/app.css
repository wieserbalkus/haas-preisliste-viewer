:root{
  --bg:#f7f7f5;
  --card:#ffffff;
  --ink:#111827;
  --muted:#6b7280;
  --row:#fbfbfb;
  --head:#fff6e6;
  --accent:#f59e0b;
  --line:#e6e6e3;
  --drawer-h: 75vh;          /* geöffneter Drawer: Höhe */
  --drawer-collapsed: 44px;  /* geschlossener Drawer: Menühöhe */
  --chrome-offset: 340px;    /* dynamisch per JS überschrieben (Controls + Filter + thead) */
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:var(--ink);font:14px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
.wrap{max-width:2000px;margin:28px auto;padding:0 16px}
.panel{background:var(--card);border-radius:12px;box-shadow:0 6px 22px rgba(0,0,0,.06);overflow:hidden}

/* ===== Steuerleiste (ohne obere graue Leiste) =====
   Grid:
     - links: Titel (oben) + Button (darunter)
     - mitte: Logo zentriert (optisch auf einer Linie mit Titel), Container mit fixer Höhe,
              das Logo selbst ist absolut positioniert -> größer möglich ohne Gesamthöhe zu erhöhen
     - rechts: Dateistatus + Blattwahl
*/
.controls{
  display:grid;
  grid-template-columns: 1fr auto 1fr;
  align-items:center;
  gap:12px;
  padding:10px 16px;
  border-bottom:1px solid var(--line);
  background:#fff;
}
.controls-left{
  display:flex;
  flex-direction:column;       /* Titel über dem Button */
  align-items:flex-start;
  gap:6px;
  min-width:0;
}
.version-chip{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:12px;
  color:var(--muted);
}
.version-chip .badge{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:2px 8px;
  border-radius:999px;
  background:var(--ink);
  color:#fff;
  font-weight:600;
  font-size:11px;
  line-height:1;
  letter-spacing:0.015em;
}
.controls-center{
  position:relative;
  height:36px;                 /* Fixe Zeilenhöhe -> Kopf bleibt flach */
  width:220px;                 /* sanfte Begrenzung, optional */
  overflow:visible;
  justify-self:center;
}
.controls-right{
  justify-self:end;
  display:flex;flex-direction:column;align-items:flex-end;gap:6px;
  width:100%;
}

/* Größeres Logo, ohne Schatten/Animation, in der Mitte vertikal ausgerichtet */
.brand img{
  position:absolute;left:50%;top:50%;
  transform:translate(-50%,-50%);
  height:64px;                 /* << größerer Logo-Wert */
  display:block;
}
@media (max-width:700px){ .brand img{height:52px} }

/* Formelemente in der Steuerleiste */
.controls select{height:36px;padding:8px 10px;border:1px solid #d1d5db;border-radius:8px}
.controls button{height:36px;padding:8px 10px;border:1px solid #d1d5db;border-radius:8px}

/* Flacherer Pill-Button (z.B. Zurücksetzen + manueller Button) */
.pill{
  background:var(--accent);color:#fff;border:none;cursor:pointer;
  height:32px !important;      /* etwas flacher */
  padding:6px 10px !important;
}
.pill:hover{filter:brightness(.95)}

.muted{color:var(--muted)}
.current{font-weight:600}
.inline-title{
  font-size:16px;font-weight:600;line-height:1;margin:2px 0 2px 0;
  white-space:nowrap;
}

.statusline{display:block;max-width:520px;text-align:left;font-size:12px;line-height:1.2;color:var(--muted);min-height:1.2em}
.statusline[data-status="ok"]::before{content:"✓ ";font-weight:700}
.statusline[data-status="info"]::before{content:"ℹ︎ ";font-weight:700}
.statusline[data-status="warn"]::before{content:"⚠︎ ";font-weight:700}

.status-version-row{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:12px;
  width:100%;
}

.status-version-row .statusline{
  flex:1 1 auto;
}

.version-link{
  text-decoration:none;
  color:inherit;
}

/* << NEU: Stil für den [Anleitung]-Link rechts oben */
.help-link{
  margin-left:8px;
  font-size:12px;
  text-decoration:underline;
  color: var(--accent);
  white-space:nowrap;
}
.help-link:hover{ filter:brightness(.95); }

@media (max-width:720px){
  .controls{grid-template-columns: 1fr 1fr; grid-template-areas:
    "left right"
    "center center";
  }
  .controls-left{grid-area:left}
  .controls-center{grid-area:center;margin-top:4px}
  .controls-right{grid-area:right;align-items:stretch}
  .statusline{text-align:left}
}

/* ===== Filter ===== */
.filters{display:grid;grid-template-columns:repeat(4,1fr);gap:6px;padding:8px 16px;border-bottom:1px solid var(--line);background:#fffdf6}
.filters input, .filters select{height:30px;padding:4px 6px;border:1px solid #d1d5db;border-radius:6px}
.filters .row-wide{grid-column:1/-1}

/* ===== Tabelle / Scrollverhalten ===== */
.table-wrap{
  overflow:auto;border-top:1px solid var(--line);
  height: calc(100vh - var(--chrome-offset) - var(--drawer-collapsed));
  max-height: calc(100vh - var(--chrome-offset) - var(--drawer-collapsed));
}
body.drawer-open .table-wrap{
  height: calc(100vh - var(--chrome-offset) - var(--drawer-h));
  max-height: calc(100vh - var(--chrome-offset) - var(--drawer-h));
}

table{width:100%;border-collapse:separate;border-spacing:0;table-layout:fixed}
thead th{position:sticky;top:0;background:var(--head);z-index:20;text-align:left;font-weight:600;padding:8px;border-bottom:1px solid #d8dee6}
thead th:first-child{left:0;z-index:21}
td:first-child{position:sticky;left:0;background:inherit;z-index:10}

tbody tr.group{background:#fff9ed}
tbody tr.group td:first-child{z-index:11}
tbody tr.group{ scroll-margin-top: 52px; }

tbody td{padding:6px 8px;border-bottom:1px solid #eef0f3;vertical-align:top}
tbody tr:nth-child(even):not(.group){background:var(--row)}
.right{text-align:right}
th.center,td.center{text-align:center}
.empty{padding:24px;text-align:center;color:var(--muted)}
.desc{white-space:pre-wrap;line-height:1.35em;word-break:break-word;overflow-wrap:anywhere}
.no-sort{
  cursor:default;
  user-select:text;
}
.no-sort::after{display:none !important;content:none !important;}
.qty{width:72px;text-align:right}
.qty::placeholder{color:#bbb}

.control-cell{vertical-align:top;text-align:right}
.qty-action{display:flex;align-items:flex-start;justify-content:flex-end;gap:8px;flex-wrap:wrap}
.qty-action .qty{flex:0 0 72px}
.qty-action .btn-plus{flex:0 0 auto}
@media (min-width:1200px){
  .qty-action{flex-wrap:nowrap}
}
.alt-flag,.alt-flag-basket{display:inline-flex;align-items:center;justify-content:center;width:28px;height:28px;border-radius:6px;color:var(--muted);cursor:pointer}
.alt-flag input,.alt-flag-basket input{width:18px;height:18px;accent-color:var(--accent)}
.btn-plus{min-width:28px;height:28px;border:1px solid #d1d5db;border-radius:6px;background:#fff;cursor:pointer;line-height:1;display:inline-flex;align-items:center;justify-content:center;padding:0 10px;gap:4px;font-size:.875rem;white-space:nowrap;transition:background-color .2s ease,color .2s ease,border-color .2s ease}
.btn-plus:hover{background:#fff9f0;border-color:#f59e0b}
.btn-plus.added{background:#f59e0b;color:#fff;border-color:#f59e0b}
.btn-plus.removed{background:#f87171;color:#fff;border-color:#ef4444}
.btn-plus:disabled{opacity:.4;cursor:not-allowed}

.cell-edit{width:100%;border:1px solid #d1d5db;border-radius:6px;padding:6px 8px;font:inherit;color:inherit;background:#fff}
.cell-edit.ta{min-height:28px;height:34px;resize:vertical;overflow:hidden;line-height:1.25}
.cell-edit.price{ text-align:right }
.cell-edit:focus{outline:2px solid #f59e0b22;border-color:#f59e0b}

.desc a{ text-decoration:underline; word-break:break-all; }

/* ===== Bottom Drawer ===== */
.summary{
  position:fixed;left:0;right:0;bottom:0;margin:0;border-top:1px solid var(--line);
  background:#fff;transform:translateY(calc(100% - var(--drawer-collapsed)));
  transition:transform .18s ease;z-index:1000;padding:0;box-shadow:0 -10px 28px rgba(0,0,0,.12);
}
.summary.open{ transform:translateY(0); }
.drawer-head{display:flex;align-items:center;justify-content:space-between;gap:10px;height:var(--drawer-collapsed);padding:0 10px 0 6px;background:#fffdf6;border-bottom:1px solid var(--line)}
.drawer-left{display:flex;align-items:center;gap:10px;width:100%}
.drawer-toggle{display:flex;align-items:center;gap:10px;height:32px;padding:0 12px;border:1px solid #e6e6e3;border-radius:999px;background:#fff;cursor:pointer;font-weight:700}
.drawer-toggle:hover{background:#fff9f0;border-color:#f59e0b80}
.icon-btn{display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;border:1px solid #e6e6e3;border-radius:8px;background:#fff;cursor:pointer}
.icon-btn:hover{background:#fff9f0;border-color:#f59e0b80}
.icon{font-style:normal;line-height:1;font-size:16px}
.drawer-body{height:var(--drawer-h);overflow:auto;padding:10px 16px 14px}
.summary h3{margin:6px 0 8px 0;font-size:15px}
.summary table{width:100%;table-layout:auto}
.summary th,.summary td{padding:6px 8px;border-bottom:1px dashed #eee}
.summary tbody td{vertical-align:top}
.summary th.center{text-align:center}
.summary .tot{font-weight:700}
.summary td.artnr-cell{width:120px}
.summary td.desc-cell{min-width:220px}
.summary td.price-cell,.summary td.qty-cell,.summary td.unit-cell,.summary td.alt-cell{vertical-align:top}
.summary td.qty-cell{text-align:right}
.summary td.unit-cell{text-align:left}
.summary td.alt-cell{text-align:center;width:60px}
.summary td.alt-cell .alt-flag-basket{justify-content:center}
.summary tr.alt-item td{font-style:italic;opacity:.92}
.summary tr.alt-item input,.summary tr.alt-item textarea,.summary tr.alt-item .price-editor,.summary tr.alt-item .price-editor input,.summary tr.alt-item .unit-input,.summary tr.alt-item .qty-unit{font-style:normal;opacity:1}
.summary tr.alt-item .manual-editor,.summary tr.alt-item .manual-editor input,.summary tr.alt-item .manual-editor textarea{font-style:normal}
.summary td.alt-total{font-style:italic;opacity:.85}
.summary tfoot .total-main .total-cell{font-weight:700}
.summary tfoot .total-alt .total-cell{font-style:italic;opacity:.85}
.summary #sum-alt{font-style:italic}
.summary .qty-input{width:90px;text-align:right;padding:6px 8px;border:1px solid #d1d5db;border-radius:6px;background:#fff;font:inherit;color:inherit}
.summary .qty-input:focus{outline:2px solid #f59e0b22;border-color:#f59e0b}
.summary .qty-input.invalid,.summary tr.invalid .qty-input{border-color:#b91c1c}
.summary tr.invalid td{background:rgba(220,38,38,.06)}
.summary tr[data-manual="true"] .manual-editor{display:flex;flex-direction:column;gap:6px}
.summary .manual-title{width:100%;padding:6px 8px;border:1px solid #d1d5db;border-radius:6px;background:#fff;font:inherit;color:inherit}
.summary .manual-title:focus{outline:2px solid #f59e0b22;border-color:#f59e0b}
.summary .manual-desc{width:100%;min-height:48px;padding:6px 8px;border:1px solid #d1d5db;border-radius:6px;background:#fff;font:inherit;color:inherit;line-height:1.35;resize:vertical}
.summary .manual-desc:focus{outline:2px solid #f59e0b22;border-color:#f59e0b}
.summary .price-editor{display:flex;align-items:flex-start;justify-content:flex-end}
.summary .price-input{width:100%;text-align:right;padding:6px 8px;border:1px solid #d1d5db;border-radius:6px;background:#fff;font:inherit;color:inherit}
.summary .price-input:focus{outline:2px solid #f59e0b22;border-color:#f59e0b}
.summary .price-input.invalid{border-color:#b91c1c}
.summary .unit-cell .unit-input{min-width:70px;text-align:left;padding:6px 8px;border:1px solid #d1d5db;border-radius:6px;background:#fff;font:inherit;color:inherit}
.summary .unit-input:focus{outline:2px solid #f59e0b22;border-color:#f59e0b}
.summary .unit-input.invalid{border-color:#b91c1c}
.summary .qty-unit{min-width:42px;text-align:left;font-size:12px;color:var(--muted)}
.summary td.action{text-align:center}
.summary .remove-line{width:32px;height:32px;border:1px solid #e6e6e3;border-radius:8px;background:#fff;cursor:pointer;display:inline-flex;align-items:center;justify-content:center}
.summary .remove-line:hover{background:#fff1f2;border-color:#ef4444;color:#b91c1c}
.summary tbody .empty td{padding:18px 8px;text-align:center;color:var(--muted)}
.neg{color:#b91c1c;font-weight:600}

.meta-inputs{display:flex;gap:12px;flex-wrap:wrap;align-items:center;margin:8px 0 12px}
.meta-inputs label{font-size:12px;color:var(--muted)}
.meta-inputs input{height:34px;padding:6px 10px;border:1px solid #d1d5db;border-radius:8px;min-width:220px}

@keyframes pulse{0%{box-shadow:0 0 0 0 rgba(245,158,11,.0)}40%{box-shadow:0 0 0 6px rgba(245,158,11,.25)}100%{box-shadow:0 0 0 0 rgba(245,158,11,.0)}}
.drawer-head.pulse{animation:pulse .8s ease}

.sum-delta{transition:filter .3s, color .3s}
.sum-up::after{content:" ▲";font-weight:700}
.sum-down::after{content:" ▼";font-weight:700}
.sum-up{color:#166534}
.sum-down{color:#b91c1c}

.toast{
  position:fixed;left:14px;bottom:56px;background:#111827;color:#fff;padding:8px 12px;border-radius:10px;font-size:12px;box-shadow:0 6px 18px rgba(0,0,0,.2);
  opacity:0;transform:translateY(6px);pointer-events:none;transition:opacity .18s ease, transform .18s ease;z-index:1100
}
.toast.show{opacity:1;transform:translateY(0)}

@media (max-width:1200px){
  .data-table .col-ehinfo{display:none}
  .data-table thead th:nth-child(5), .data-table tbody td:nth-child(5){display:none}
}
@media (max-width:980px){ thead th,tbody td{padding:6px 6px} td.right,th.right{font-size:13px} }
@media (max-width:720px){ tbody td{padding:5px 6px} .desc{line-height:1.25} }

mark.hl{
  background:#fde68a;
  color:inherit;
  padding:0 0.1em;
  border-radius:3px;
  box-shadow:0 0 0 1px #f59e0b66 inset;
}
